#
# Configuration file for 'install-server.sh' and 'install-agent.sh' of
# the 'gfarm_zabbix' package.
#

######################################################################
# Common parameters.
######################################################################

# Directory where configuration files for Zabbix server reside.
# It MUST be the home directory of 'zabbix' user.
ZABBIX_CONFDIR=/etc/zabbix

# Syslog file which logs messages reported by gfmd, gfsd and gfarm2fs.
SYSLOG_FILE=/var/log/messages

# Directory where external scripts for Zabbix reside.
ZABBIX_EXTSCRIPTDIR=$ZABBIX_CONFDIR/externalscripts

# Directory where alert scripts for Zabbix reside.
ZABBIX_ALERTSCRIPTDIR=$ZABBIX_CONFDIR/alertscripts

# Directory where commands related to Gfarm (e.g. gfhost) exist.
GFARM_BINDIR=/usr/local/gfarm/bin

######################################################################
# Parameters for Zabbix server.
######################################################################

# Directory where data files of Zabbix are installed.
ZABBIX_DATADIR=/usr/share/zabbix

# Directory where document files of Zabbix are installed.
ZABBIX_DOCDIR=/usr/share/doc/zabbix-server-1.8.10

# Directory where configurations files for Apache HTTP Server reside
# (path to 'conf.d' directory or where 'httpd.conf' exists).  If the
# value is empty, a sample configuration file ('zabbix.conf.sample')
# will not be installed at the directory.
APACHE_CONFDIR=/etc/httpd/conf.d

# Top HTML directory (also known as "DocumentRoot")
HTMLDIR=/var/www/html

# User (owner) and group of $HTMLDIR directory.
HTMLDIR_USER=apache
HTMLDIR_GROUP=apache

# Timezone name PHP recognizes.
# See http://www.php.net/manual/en/timezones.php for more details.
PHP_TIMEZONE=Asia/Tokyo

# Directory where a configuration file for MySQL server ('my.cnf')
# resides.  If the value is empty, a sample configuration file
# ('my.cnf.sample') will not be installed at the directory.
MYSQL_CONFDIR=/etc

# Database name, user and password.
DB_NAME=zabbix
DB_USER=zabbix
DB_PASSWORD=zabbix

# Node ID of the Zabbix server.
ZABBIX_NODEID=0

######################################################################
# Parameters for Zabbix agentd.
######################################################################

# Directory where configuration files for Zabbix server reside.
ZABBIX_AGENTD_CONFSUBDIR=/etc/zabbix/zabbix_agentd.d

# An IP address of Zabbix server.
ZABBIX_SERVER=192.168.0.1

# Hostname displayed on Zabbix Web UI.
ZABBIX_AGENT_HOSTNAME=`hostname`

# PID file of gfmd.
GFMD_PID_FILE=/var/run/gfmd.pid

# Monitoring target device using 'iostat' command.
IOSTAT_DEVICE="sda"

######################################################################
# Functions. (do not edit)
######################################################################

#
# Create "$1" file from "$1.in".
#
create_zabbix_server_file()
{
    [ -f "$1" ] && rm -f "$1"
    sed -e "s|@ZABBIX_CONFDIR@|$ZABBIX_CONFDIR|g" \
	-e "s|@SYSLOG_FILE@|$SYSLOG_FILE|g" \
	-e "s|@ZABBIX_EXTSCRIPTDIR@|$ZABBIX_EXTSCRIPTDIR|g" \
	-e "s|@ZABBIX_ALERTSCRIPTDIR@|$ZABBIX_ALERTSCRIPTDIR|g" \
	-e "s|@GFARM_BINDIR@|$GFARM_BINDIR|g" \
	-e "s|@ZABBIX_DATADIR@|$ZABBIX_DATADIR|g" \
	-e "s|@APACHE_CONDIR@|$APACHE_CONDIR|g" \
	-e "s|@HTMLDIR@|$HTMLDIR|g" \
	-e "s|@HTMLDIR_USER@|$HTMLDIR_USER|g" \
	-e "s|@HTMLDIR_GROUP@|$HTMLDIR_GROUP|g" \
	-e "s|@PHP_TIMEZONE@|$PHP_TIMEZONE|g" \
	-e "s|@MYSQL_CONFDIR@|$MYSQL_CONFDIR|g" \
	-e "s|@DB_NAME@|$DB_NAME|g" \
	-e "s|@DB_USER@|$DB_USER|g" \
	-e "s|@DB_PASSWORD@|$DB_PASSWORD|g" \
	-e "s|@ZABBIX_NODEID@|$ZABBIX_NODEID|g" \
	"$1.in" > "$1"
}

#
# Create "$1" file from "$1.in".
#
create_zabbix_agent_file()
{
    [ -f "$1" ] && rm -f "$1"
    sed -e "s|@ZABBIX_CONFDIR@|$ZABBIX_CONFDIR|g" \
	-e "s|@SYSLOG_FILE@|$SYSLOG_FILE|g" \
	-e "s|@ZABBIX_EXTSCRIPTDIR@|$ZABBIX_EXTSCRIPTDIR|g" \
	-e "s|@ZABBIX_ALERTSCRIPTDIR@|$ZABBIX_ALERTSCRIPTDIR|g" \
	-e "s|@GFARM_BINDIR@|$GFARM_BINDIR|g" \
	-e "s|@ZABBIX_AGENTD_CONFSUBDIR@|$ZABBIX_AGENTD_CONFSUBDIR|g" \
	-e "s|@ZABBIX_SERVER@|$ZABBIX_SERVER|g" \
	-e "s|@ZABBIX_AGENT_HOSTNAME@|$ZABBIX_AGENT_HOSTNAME|g" \
	-e "s|@GFMD_PID_FILE@|$GFMD_PID_FILE|g" \
	-e "s|@IOSTAT_DEVICE@|$IOSTAT_DEVICE|g" \
	"$1.in" > "$1"
}
